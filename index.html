<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jassgenossen Schällebur - Leaderboard</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        body { background-color: #f8fafc; font-family: 'Inter', sans-serif; }
        .loading-spinner { border-top-color: transparent; }
        /* Style for the logo placeholder if the image fails */
        #logo-container {
            display: flex;
            align-items: center;
            justify-content: center;
    /* Hintergrundmuster für den Header (Ihr Schälle-Bild, Base64) */
    .header-bg-pattern {
        /* Das Bild ist als Base64-Daten enthalten */
        background-image:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAMAAAAp4XiDAAAAM1BMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACHxR1VAAAAEHRSTlMA////AP///////////v7+/v7++22U7wAAAFtJREFUeNqdzFsSwCAAAzD/D73w0QcW2sA2+mBqVpQp19SgV20yK4mBv3wH+v1+e6/9oX1b3+h09g83+O8B88/5J575Vz76xXz0D779h5/x9x89g++79w/D33z2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D33z2Dzf47wHzz/knnflXPvrFfPQPP/3Hn/H3Hz2D4f33z/D3H/z/eAAAAAElFTkSuQmCC');
            background-repeat: repeat;
            background-size: 50px 50px;
        }
    </style>
</head>
<body>
    <div id="app">
        <!-- The entire application will be rendered here -->
    </div>

    <!-- Firebase Imports -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, collection, addDoc, onSnapshot, query, serverTimestamp, deleteDoc, doc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // ------------------------------------------------------------------
        // ##################################################################
        // SCHRITT 1: FÜGEN SIE IHRE FIREBASE KONFIGURATION HIER EIN!
        // ------------------------------------------------------------------
        
    const firebaseConfig = {
        apiKey: "AIzaSyAPkAhM-BhJfG5cljBk2S2KGN3TIg8IxXM",
        authDomain: "jassgenossenschaellebur.firebaseapp.com",
        projectId: "jassgenossenschaellebur",
        storageBucket: "jassgenossenschaellebur.firebasestorage.app",
        messagingSenderId: "409989986638",
        appId: "1:409989986638:web:b1f4cd88b0521c92dac61f",
        measurementId: "G-BBFM2BD01V"
};

        // --- Constants ---
        const COLLECTION_NAME = 'jass_games';
        // HINWEIS: Dies ist die URL, die Sie von GitHub bereitgestellt haben.
        // Stellen Sie sicher, dass dies der RAW-Link ist, damit er öffentlich zugänglich ist!
        const LOGO_URL = "https://github.com/user-attachments/assets/aebb9a7b-aa92-4643-be2b-8dd06c255eea"; // Ihr Club-Logo
        const ACCESS_CODE = '1993'; // <-- Zugangscode für Punkteingabe
        // Define primary gold and black colors for consistency
        const PRIMARY_GOLD = 'bg-yellow-500';
        const PRIMARY_GOLD_HOVER = 'hover:bg-yellow-600';
        const PRIMARY_BLACK_TEXT = 'text-gray-900';
        const PRIMARY_BLACK_HEADER = 'bg-gradient-to-br from-gray-900 to-gray-700';

        // Startpunkte der Spieler (weniger ist besser!)
        const initialPlayers = [
            { id: 'diego', name: 'Diego', score: 311, color: 'bg-red-500' },
            { id: 'toni', name: 'Toni', score: 208, color: 'bg-blue-500' },
            { id: 'laurent', name: 'Laurent', score: 218, color: 'bg-green-500' },
            { id: 'jerome', name: 'Jérôme', score: 199, color: 'bg-yellow-500' },
        ];


        // --- Utility Functions ---
        
        const renderErrorState = (message, details = "") => `
            <div class="min-h-screen bg-slate-50 flex flex-col items-center justify-center p-8 text-center">
                <i data-lucide="alert-triangle" class="text-red-500 w-12 h-12 mb-4"></i>
                <h1 class="text-2xl font-bold text-red-700 mb-2">Website Fehler</h1>
                <p class="text-slate-600 max-w-md">${message}</p>
                ${details ? `<p class="text-sm text-slate-500 mt-3 p-3 bg-red-100 rounded-lg">${details}</p>` : ''}
                <p class="text-xs text-slate-400 mt-4">Prüfen Sie Ihre 'index.html' und die Firebase Konsole.</p>
            </div>
        `;


        // --- Firebase Initialization ---
        let app, auth, db;
        let isConfigured = false;
        
        // CHECK if any key is provided
        if (!firebaseConfig.apiKey) {
            document.getElementById('app').innerHTML = renderErrorState(
                "Fehler: Firebase Konfiguration fehlt.",
                "Bitte fügen Sie Ihre Firebase Schlüssel in die 'firebaseConfig'-Variable in der 'index.html' ein."
            );
        } else {
            try {
                app = initializeApp(firebaseConfig);
                auth = getAuth(app);
                db = getFirestore(app);
                isConfigured = true;
            } catch (e) {
                console.error("Firebase Init Error:", e);
                document.getElementById('app').innerHTML = renderErrorState("Fehler beim Initialisieren von Firebase.", e.message);
            }
        }
        
        let user = null;
        let games = [];
        let activeTab = 'leaderboard';
        let leaderboard = [];
        
        // --- Utility Functions (continued) ---

        /** Renders a common card component */
        const renderCard = (content, className = "") => `
            <div class="bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden ${className}">
                ${content}
            </div>
        `;
        
        const renderLoading = () => `
            <div class="min-h-screen bg-slate-50 flex items-center justify-center">
                <div class="animate-spin rounded-full h-12 w-12 border-4 ${PRIMARY_GOLD.replace('bg-', 'border-')} loading-spinner"></div>
            </div>
        `;

        const renderHeader = () => `
            <header class="${PRIMARY_BLACK_HEADER} header-bg-pattern text-white pt-8 pb-16 px-4 shadow-lg relative overflow-hidden">
                
                <!-- Logo mit der vollen Bildgröße -->
                <div class="max-w-md mx-auto text-center relative z-10">
                    <div id="logo-container" class="bg-white/90 w-28 h-28 rounded-full flex items-center justify-center mx-auto mb-4 p-2 shadow-xl">
                        <!-- Logo-Bild -->
                        <img 
                            src="${LOGO_URL}" 
                            alt="Jassgenossen Schällebur Logo" 
                            class="w-full h-full object-contain rounded-full"
                        />
                    </div>
                    <h1 class="text-2xl font-bold tracking-tight mb-1">Jassgenossen Schällebur</h1>
                    <p class="text-gray-100 text-sm font-medium opacity-90">Est. 2020 • Zürich</p>
                </div>
            </header>
        `;

        const renderNavigation = () => `
            ${activeTab !== 'about' ? renderCard(`
                <div class="flex p-1 bg-slate-100 border-none">
                    <button onclick="setActiveTab('leaderboard')" class="flex-1 py-2 text-sm font-medium rounded-lg transition-all ${activeTab === 'leaderboard' ? `${PRIMARY_GOLD.replace('bg-', 'bg-')} ${PRIMARY_BLACK_TEXT} shadow-sm` : 'text-slate-500'}">Rankings</button>
                    <button onclick="setActiveTab('add')" class="flex-1 py-2 text-sm font-medium rounded-lg transition-all ${activeTab === 'add' ? `${PRIMARY_GOLD.replace('bg-', 'bg-')} ${PRIMARY_BLACK_TEXT} shadow-sm` : 'text-slate-500'}">Punkte eintragen</button>
                    <button onclick="setActiveTab('history')" class="flex-1 py-2 text-sm font-medium rounded-lg transition-all ${activeTab === 'history' ? `${PRIMARY_GOLD.replace('bg-', 'bg-')} ${PRIMARY_BLACK_TEXT} shadow-sm` : 'text-slate-500'}">History</button>
                </div>
            `, "flex p-1 bg-slate-100 border-none") : ''}
        `;
        
        const getLeaderboard = (gameResults) => {
            // Kopieren der initialen Spielerdaten, um sie nicht zu überschreiben
            const leaderboard = JSON.parse(JSON.stringify(initialPlayers));

            // Punkte aus Firestore auf die Startpunkte addieren
            gameResults.forEach(result => {
                const player = leaderboard.find(p => p.id === result.playerId);
                if (player) {
                    // Strafpunkte werden addiert (da weniger Punkte besser ist)
                    player.score += result.points;
                }
            });

            // LOGIK: Sortieren nach aufsteigender Punktzahl (weniger Punkte = besser/Platz 1)
            leaderboard.sort((a, b) => a.score - b.score);

            // Rang zuweisen
            leaderboard.forEach((player, index) => {
                player.rank = index + 1;
            });

            return leaderboard;
        };

        const renderLeaderboard = () => `
            <div class="space-y-4">
                <ul id="leaderboard-list" class="grid gap-3">
                    ${leaderboard.map((player) => {
                        const isLeader = player.rank === 1;
                        const isLast = player.rank === initialPlayers.length;

                        const rankText = isLeader ? 
                            `<span class="text-yellow-500" data-lucide="crown"></span>` : 
                            `#${player.rank}`;
                        
                        return `
                            <li class="p-4 flex items-center justify-between rounded-xl shadow-lg mb-3 ${isLeader ? 'bg-yellow-50 border-yellow-300 border-2 scale-[1.02]' : isLast ? 'bg-gray-100 border-gray-300 border' : 'bg-white border-gray-200 border'} transition-all duration-300">
                                <!-- Rang & Name -->
                                <div class="flex items-center space-x-4">
                                    <div class="font-bold text-xl w-8 text-center ${isLeader ? 'text-yellow-700' : 'text-gray-500'}">
                                        <i data-lucide="${isLeader ? 'crown' : 'hash'}" class="w-6 h-6 inline-block align-middle"></i>
                                    </div>
                                    <span class="text-lg font-semibold text-gray-800">${player.name}</span>
                                </div>
                                
                                <!-- Punkte -->
                                <div class="text-2xl font-extrabold ${isLeader ? 'text-amber-700' : 'text-gray-700'}">
                                    ${player.score} <span class="text-sm font-normal text-gray-500">CHF</span>
                                </div>
                            </li>
                        `;
                    }).join('')}
                </ul>
                
                <div class="bg-blue-50 border border-blue-100 rounded-lg p-4 mt-6">
                    <h4 class="text-blue-800 font-semibold text-sm mb-1 flex items-center gap-2">
                        <i data-lucide="users" class="w-4 h-4"></i> Club Zweck
                    </h4>
                    <p class="text-blue-900/80 text-sm leading-relaxed">
                        Wir sind Jassgenossen Schällebur. Wir pflegen die Kunst des Jassens, die Freundschaft und die Vereinskasse (durch Strafen für schlechtes Spiel!). Weniger Punkte = Bester Spieler!
                    </p>
                </div>
            </div>
        `;

        const renderAddScore = () => `
            ${renderCard(`
                <h2 class="text-lg font-bold text-slate-800 mb-4 flex items-center gap-2">
                    <i data-lucide="plus-circle" class="${PRIMARY_GOLD.replace('bg-', 'text-')} w-5 h-5"></i> Neue Punkte (Strafen) eintragen
                </h2>
                <div id="message-box" class="hidden p-3 rounded-lg text-sm mb-4"></div>
                <form id="score-form" class="space-y-4">
                    
                    <div class="p-3 bg-gray-50 rounded-lg border border-gray-200 mb-4">
                        <label for="security-code" class="block text-xs font-semibold uppercase text-gray-500 mb-1">Zugangscode</label>
                        <input
                            type="password"
                            id="security-code"
                            placeholder="Code: ${ACCESS_CODE}"
                            class="w-full bg-white border border-gray-300 rounded-lg px-4 py-2 font-mono text-lg focus:outline-none focus:ring-2 focus:ring-gray-500 transition-all"
                        />
                    </div>
                    
                    <div>
                        <label for="player-select" class="block text-sm font-medium text-slate-700 mb-1">Spieler wählen</label>
                        <select id="player-select" class="w-full bg-slate-50 border border-slate-200 rounded-lg px-4 py-3 text-lg font-semibold focus:outline-none focus:ring-2 ${PRIMARY_GOLD.replace('bg-', 'focus:ring-')}">
                            ${initialPlayers.map(p => `<option value="${p.id}">${p.name}</option>`).join('')}
                        </select>
                    </div>

                    <div>
                        <label for="points-input" class="block text-sm font-medium text-slate-700 mb-1">Strafpunkte (CHF)</label>
                        <input
                            type="number"
                            id="points-input"
                            placeholder="z.B. 5"
                            min="1"
                            class="flex-1 w-full bg-slate-50 border border-slate-200 rounded-lg px-4 py-3 text-lg font-semibold focus:outline-none focus:ring-2 ${PRIMARY_GOLD.replace('bg-', 'focus:ring-')} focus:border-transparent transition-all"
                        />
                    </div>
                    
                    <div class="pt-4">
                        <button type="submit" id="submitBtn" class="w-full text-lg px-4 py-3 rounded-lg font-medium transition-all active:scale-95 flex items-center justify-center gap-2 ${PRIMARY_GOLD} ${PRIMARY_BLACK_TEXT} ${PRIMARY_GOLD_HOVER} shadow-xl shadow-yellow-800/20">
                            Punkte speichern
                        </button>
                    </div>
                </form>
            `, "p-6")}
        `;

        const renderHistory = () => `
            <div class="space-y-4">
                <h2 class="font-bold text-slate-500 text-sm uppercase tracking-wider ml-1">Letzte Einträge</h2>
                ${games.length === 0 ? `
                    <div class="text-center py-12 text-slate-400">
                        <i data-lucide="history" class="mx-auto mb-3 opacity-20 w-12 h-12"></i>
                        <p>Noch keine Punkte eingetragen.</p>
                    </div>
                ` : games.map(game => {
                    const player = initialPlayers.find(p => p.id === game.playerId);
                    const playerName = player ? player.name : 'Unbekannt';
                    return `
                        ${renderCard(`
                            <div class="flex justify-between items-start mb-3 border-b border-slate-100 pb-2">
                                <div class="text-xs font-semibold text-slate-400 flex items-center gap-1">
                                    <i data-lucide="calendar" class="w-3 h-3"></i>
                                    ${game.timestamp?.toDate ? game.timestamp.toDate().toLocaleDateString('de-CH') : 'Gerade jetzt'}
                                </div>
                                <button 
                                    onclick="handleDeleteGame('${game.id}')"
                                    class="text-xs text-red-300 hover:text-red-600 px-2">
                                    Löschen
                                </button>
                            </div>
                            <div class="flex justify-between pr-4 text-lg font-bold">
                                <span class="text-slate-600">${playerName}</span>
                                <span class="text-red-600">+${game.points} CHF</span>
                            </div>
                            <div class="text-xs text-slate-400 mt-1">Eingetragen von: ${game.recordedBy.substring(0, 8)}...</div>
                        `, "p-4")}
                    `;
                }).join('')}
            </div>
        `;

        const renderMobileNav = () => `
            <nav class="fixed bottom-0 left-0 right-0 bg-white border-t border-slate-200 px-6 py-3 flex justify-around items-center z-50 md:hidden">
                <button onclick="setActiveTab('leaderboard')" class="flex flex-col items-center gap-1 ${activeTab === 'leaderboard' ? PRIMARY_BLACK_TEXT : 'text-slate-400'}">
                    <i data-lucide="trophy" class="w-5 h-5 ${activeTab === 'leaderboard' ? 'stroke-[2.5]' : ''}"></i>
                    <span class="text-[10px] font-medium">Rankings</span>
                </button>
                <button onclick="setActiveTab('add')" class="${PRIMARY_GOLD} ${PRIMARY_BLACK_TEXT} p-3 rounded-full shadow-lg shadow-yellow-800/30 -mt-6 border-4 border-slate-50">
                    <i data-lucide="plus-circle" class="w-6 h-6"></i>
                </button>
                <button onclick="setActiveTab('history')" class="flex flex-col items-center gap-1 ${activeTab === 'history' ? PRIMARY_BLACK_TEXT : 'text-slate-400'}">
                    <i data-lucide="history" class="w-5 h-5 ${activeTab === 'history' ? 'stroke-[2.5]' : ''}"></i>
                    <span class="text-[10px] font-medium">History</span>
                </button>
            </nav>
        `;

        const renderApp = () => {
            let content = '';
            if (activeTab === 'leaderboard') {
                content = renderLeaderboard();
            } else if (activeTab === 'add') {
                content = renderAddScore();
            } else if (activeTab === 'history') {
                content = renderHistory();
            }

            document.getElementById('app').innerHTML = `
                ${renderHeader()}
                <main class="max-w-md mx-auto px-4 -mt-8 relative z-10 space-y-6">
                    ${renderNavigation()}
                    ${content}
                </main>
                ${renderMobileNav()}
            `;
            // Re-render Lucide icons after DOM update
            lucide.createIcons();
            attachEventListeners();
        };

        // --- Controller Functions ---

        window.setActiveTab = (tab) => {
            activeTab = tab;
            renderApp();
        };
        
        window.handleDeleteGame = async (gameId) => {
            if(!confirm("Sind Sie sicher, dass Sie diesen Spieleintrag löschen möchten?")) return; 
            try {
                // Nur registrierte User dürfen löschen
                if (!user) return alert("Fehler: Keine Berechtigung zum Löschen.");
                
                const fullPath = collection(db, COLLECTION_NAME); 
                await deleteDoc(doc(fullPath, gameId));
            } catch (error) {
                console.error("Error deleting:", error);
                alert("Der Spieleintrag konnte nicht gelöscht werden.");
            }
        };

        const attachEventListeners = () => {
            const form = document.getElementById('score-form');
            if (form) {
                form.onsubmit = handleAddGame;
            }
        };
        
        const handleAddGame = async (e) => {
            e.preventDefault();
            const accessCodeInput = document.getElementById('security-code');
            const playerId = document.getElementById('player-select').value;
            const pointsInput = document.getElementById('points-input').value;
            const messageBox = document.getElementById('message-box');
            messageBox.classList.add('hidden');

            const points = parseInt(pointsInput, 10);

            // 1. Check Access Code
            if (accessCodeInput.value !== ACCESS_CODE) {
                messageBox.textContent = 'Falscher Zugangscode. Bitte versuchen Sie es erneut.';
                messageBox.classList.remove('hidden');
                messageBox.classList.add('bg-red-100', 'text-red-800');
                accessCodeInput.value = '';
                return;
            }

            // 2. Check Points
            if (points <= 0 || isNaN(points)) {
                 messageBox.textContent = 'Bitte eine gültige positive Punktzahl (>0) eingeben.';
                 messageBox.classList.remove('hidden');
                 messageBox.classList.add('bg-red-100', 'text-red-800');
                 return;
            }
            
            const submitBtn = document.getElementById('submitBtn');
            submitBtn.textContent = 'Speichern...';
            submitBtn.disabled = true;

            try {
                const fullPath = collection(db, COLLECTION_NAME); 
                await addDoc(fullPath, {
                    playerId: playerId,
                    points: points,
                    timestamp: serverTimestamp(),
                    recordedBy: user ? user.uid : 'anonymous',
                });

                // Reset form and go to leaderboard
                document.getElementById('points-input').value = '';
                accessCodeInput.value = ''; 
                setActiveTab('leaderboard');
            } catch (error) {
                console.error("Error adding game:", error);
                messageBox.textContent = `Speicherfehler: ${error.message}. Haben Sie Ihre Firebase-Regeln korrekt gesetzt?`;
                messageBox.classList.remove('hidden');
                messageBox.classList.add('bg-red-100', 'text-red-800');
            } finally {
                submitBtn.textContent = 'Punkte speichern';
                submitBtn.disabled = false;
            }
        };

        // ------------------------------------------------------------------
        // KORRIGIERTER STARTUP-BLOCK: Erzwingt die anonyme Anmeldung direkt.
        // ------------------------------------------------------------------
        async function startApp() {
            if (!isConfigured) return;

            document.getElementById('app').innerHTML = renderLoading();

            try {
                // ERZWINGT ANONYME ANMELDUNG
                const userCredential = await signInAnonymously(auth);
                user = userCredential.user;

                // Start listening for data ONLY after successful sign-in
                const gamesRef = collection(db, COLLECTION_NAME);
                const q = query(gamesRef);

                onSnapshot(q, (snapshot) => {
                    // Startpunkte der Spieler
                    let playerTotals = {};
                    initialPlayers.forEach(p => playerTotals[p.id] = p.score);

                    games = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                    games.sort((a, b) => (b.timestamp?.toMillis() || 0) - (a.timestamp?.toMillis() || 0));

                    // Akkumulieren der neuen Punkte
                    games.forEach(game => {
                        if (game.playerId && game.points) {
                             // Füge die Punkte der Strafkasse hinzu
                            playerTotals[game.playerId] += game.points;
                        }
                    });

                    // Erstellung der finalen Bestenliste
                    const finalLeaderboard = initialPlayers.map(initial => ({
                        id: initial.id,
                        name: initial.name,
                        color: initial.color,
                        score: playerTotals[initial.id] || initial.score,
                    }));


                    leaderboard = getLeaderboard(finalLeaderboard.map(p => ({
                        id: p.id,
                        name: p.name,
                        score: p.score,
                        color: p.color
                    })));
                    
                    renderApp();
                }, (error) => {
                    console.error("Firestore error:", error);
                    document.getElementById('app').innerHTML = renderErrorState(
                        "Datenbankverbindung fehlgeschlagen.",
                        "Mögliche Ursachen: 1) Firebase-Schlüssel fehlen/falsch, 2) Firestore-Sicherheitsregeln erlauben keinen Zugriff, 3) Autorisierte Domain fehlt in Firebase Auth."
                    );
                });

            } catch (error) {
                console.error("Critical Auth Error:", error);
                document.getElementById('app').innerHTML = renderErrorState(
                    "Kritischer Anmeldefehler.",
                    `Der Browser/Server blockiert die Authentifizierung. Bitte prüfen Sie die **Autorisierten Domains** und aktivieren Sie **Anonyme Anmeldung** in Firebase Auth.`
                );
            }
        }

        startApp();
    </script>
</body>
</html>